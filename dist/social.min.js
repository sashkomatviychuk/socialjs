/*! Social - v0.1.0 - 2013-04-30
* https://github.com/ideil/socialjs
* Copyright (c) 2013 Ideil; Licensed MIT */
(function(t,e,r,n){function s(e,r){this.el=e,this.shareCount=n,this.$el=t(e),this.options=t.extend({},h,r),this._defaults=h,this._name=a,this.init()}var a="social",i={facebook:{shareUrl:"http://www.facebook.com/sharer.php?u={{pageUrl}}",countUrl:"http://graph.facebook.com/?ids={{pageUrl}}"},mailru:{shareUrl:"http://connect.mail.ru/share?url={{pageUrl}}",countUrl:"http://connect.mail.ru/share_count?callback=1&url_list={{pageUrl}}",ajaxParams:{jsonp:"func"}},vk:{shareUrl:"http://vk.com/share.php?url={{pageUrl}}",countUrl:"http://vk.com/share.php?act=count&format=json&index=0&url={{pageUrl}}",preParse:function(t){e.VK=e.VK||{},e.VK.Share=e.VK.Share||{},e.VK.Share.count=function(e,r){t.shareCount=r}}},twitter:{shareUrl:"https://twitter.com/intent/tweet?source=tweetbutton&text={{pageUrl}}",countUrl:"http://urls.api.twitter.com/1/urls/count.json?url={{pageUrl}}",parseResponse:function(t){return t.count}},pinterest:{shareUrl:"http://pinterest.com/pinthis/?url={{pageUrl}}",countUrl:"http://api.pinterest.com/v1/urls/count.json?url={{pageUrl}}",parseResponse:function(t){return t.count}},linkedIn:{shareUrl:"http://www.linkedin.com/sharer.php?u={{pageUrl}}",countUrl:"http://www.linkedin.com/countserv/count/share?url={{pageUrl}}&format=jsonp",parseResponse:function(t){return t.count}},odnoklassniki:{shareUrl:"http://www.odnoklassniki.ru/dk?st.cmd=addShare&st._surl={{pageUrl}}",countUrl:"http://www.odnoklassniki.ru/dk?st.cmd=extLike&ref={{pageUrl}}",preParse:function(t){e.ODKL=e.ODKL||{},e.ODKL.updateCount=function(e,r){t.shareCount=parseInt(r,10)}}}},o={type:"GET",dataType:"jsonp"},h={fetchCountOnInit:!1};s.prototype={init:function(){var t="";this.service=this.$el.attr("data-service"),this.pageUrl=this.$el.attr("data-href"),t=this.pageUrl?this.pageUrl:e.location.href,this.shareLink=i[this.service].shareUrl.replace("{{pageUrl}}",t),this.countLink=i[this.service].countUrl.replace("{{pageUrl}}",this.pageUrl),this.createLink(),h.fetchCountOnInit&&this.fetchShareCount()},createLink:function(){this.$el.attr("href",this.shareLink)},fetchShareCount:function(){i[this.service].preParse&&i[this.service].preParse(this),this.fetchDeferredCount().success(this.parseCount)},fetchDeferredCount:function(){return t.ajax(t.extend(!0,o,i[this.service].ajaxParams,{url:this.countLink,context:this}))},parseCount:function(e){var r=this;i[r.service].parseResponse?r.shareCount=i[r.service].parseResponse(e):t.each(e,function(t,e){r.shareCount=e.shares})},getCurrentCount:function(){return this.shareCount}},t.fn[a]=function(e){var r=this,n=this.length;return this.each(function(i){var o=t.data(this,"plugin_"+a);o?"function"==typeof o[e]&&(0===e.indexOf("get")&&(n>1?(0===i&&(r={}),r[o.service]=o[e]()):r=o[e]()),o[e]()):t.data(this,"plugin_"+a,new s(this,e))}),r}})(jQuery,window,document);